pro replot_xrt_lc,time,timerr,cts,err,xrange=xrange,_extra=_extra,file=file,hardness=hardness,ps=ps,yrange=yrange
  
  if keyword_set(ps) then begplot,name='xrt_lc.ps',/color
  simpctable
  if n_elements(file) eq 0 then file='lc_out.txt'
  readcol,file,time,tstart,tstop,cts,err,hard,harderr,expt,src,bg,sigma,exp,tot_ext_t,curr_ftype,grade0_ct

  w=where(sigma ge 3,nw)
  
  if keyword_set(hardness) then !p.multi=[0,1,2]
  if n_elements(xrange) eq 0 then xrange=[min(tstart),max(tstop)]
  if n_elements(yrange) eq 0 then begin 
      w=where(finite(err))
      yrange=[min(cts[w]-err[w]),max(cts[w]+err[w])]
     if yrange[0] lt 1e-5 then yrange[0]=1e-5
  endif 
     
  plot,time,cts,psym=3,xtitle='seconds since BAT trigger',ytitle='cts/s',title=title,/xlog,/ylog,xrange=xrange,yrange=yrange,_extra=_extra,/nodata
  
  wwt=where(curr_ftype eq 0,nwwt)
  wpc=where(curr_ftype eq 1,nwpc)
  plotsym,0,0.7,/fill
  
  if nwpc gt 0 then begin 
     oplot,time[wpc],cts[wpc],psym=8,color=!red
     for i=0,nwpc-1 do oplot,[tstart[wpc[i]],tstop[wpc[i]]],[cts[wpc[i]],cts[wpc[i]]],color=!red
     oploterror,time[wpc],cts[wpc],err[wpc],psym=3,/nohat,color=!red,errcolor=!red
     wul=where(sigma[wpc] lt 3,nwul)
     plotsym,1,5,thick=4
     if nwul gt 0 then oplot,time[wpc[wul]],cts[wpc[wul]],psym=8,color=!red
  endif 
  

  if nwwt gt 0 then begin 
     plotsym,0,0.7,/fill
     for i=0,nwwt-1 do oplot,[tstart[wwt[i]],tstop[wwt[i]]],[cts[wwt[i]],cts[wwt[i]]],color=!blue
     oploterror,time[wwt],cts[wwt],err[wwt],psym=3,/nohat,color=!blue,errcolor=!blue
     wul=where(sigma[wwt] lt 3,nwul)
     plotsym,1,5,thick=4
     if nwul gt 0 then oplot,time[wwt[wul]],cts[wwt[wul]],psym=8,color=!blue
  endif 
  
  ;;;;;;;;;;;hardness plot
  if keyword_set(hardness) then begin
     plot,time,hard,psym=3,xtitle='seconds since BAT trigger',ytitle='hardness ratio',title=title,/xlog,/ylog,xrange=xrange,yrange=[min(hard-harderr),max(hard+harderr)],_extra=_extra,/nodata
       plotsym,0,0.7,/fill
  
  if nwpc gt 0 then begin 
     oplot,time[wpc],hard[wpc],psym=8,color=!red
     for i=0,nwpc-1 do oplot,[tstart[wpc[i]],tstop[wpc[i]]],[hard[wpc[i]],hard[wpc[i]]],color=!red
     oploterror,time[wpc],hard[wpc],harderr[wpc],psym=3,/nohat,color=!red,errcolor=!red
     wul=where(sigma[wpc] lt 3,nwul)
     plotsym,1,5,thick=4
     if nwul gt 0 then oplot,time[wpc[wul]],hard[wpc[wul]],psym=8,color=!red
  endif 
  

  if nwwt gt 0 then begin 
     plotsym,0,0.7,/fill
     for i=0,nwwt-1 do oplot,[tstart[wwt[i]],tstop[wwt[i]]],[hard[wwt[i]],hard[wwt[i]]],color=!blue
     oploterror,time[wwt],hard[wwt],harderr[wwt],psym=3,/nohat,color=!blue,errcolor=!blue
     wul=where(sigma[wwt] lt 3,nwul)
     plotsym,1,5,thick=4
     if nwul gt 0 then oplot,time[wwt[wul]],hard[wwt[wul]],psym=8,color=!blue
  endif 

     !p.multi=0
  endif 
     
  if keyword_set(ps) then endplot

end
